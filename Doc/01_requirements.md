# 要件定義

## 目的
- 従業員がウェブ画面で**出勤／退勤／休憩入り・戻り**を素早く記録できるようにする。
- 管理者が**月次CSVを出力**し、賃金計算と監査対応に使えるようにする。
  - 事実：賃金台帳等は**原則5年**保存（当分の間は3年の経過措置）。citeturn5view2

## 利用者像
- 従業員：当日の打刻と自分の記録の確認。
- 承認者：打刻ミスの**修正申請**を確認し、承認または却下。
- 管理者：従業員・シフト設定、修正の最終反映、**CSVエクスポート**、監査対応。

## 機能要件（監査を満たす最小）
1. **打刻（Webフォーム）**  
   - ボタンで「出勤」「退勤」「休憩入り」「休憩戻り」を登録。  
   - 端末時刻のズレ対策として**サーバー時刻**で記録する。
2. **修正申請フロー**  
   - 従業員は理由を添えて修正申請。承認者が画面で審査。  
   - 変更は**履歴テーブルに追記**し、元データを消さない。
3. **監査証跡**  
   - 生イベント（打刻・申請・承認）を**追記専用**で保存。  
   - イベントを**ハッシュで連鎖**し、**日次スナップショットのハッシュ**を固定化する（改ざん検知）。
4. **出力（CSV）**  
   - 従業員ID / 日付 / 始業 / 終業 / 休憩合計 / 実労働時間 / 修正有無 の**月次CSV**。
5. **保存期間と保全**  
   - データは**5年保存**を基本設計とし、WINGの**自動バックアップ14日間**も把握しておく。citeturn2search8

## 非機能要件（抜粋）
- **可用性**：常駐プロセスなし。HTTP＋cronのみで動く。citeturn2search0
- **セキュリティ**：HTTPS化（無料独自SSL）、WAF有効、**管理画面に認証**と多段の防御。citeturn0search0turn0search4
- **保守性**：設定は環境変数に集約。SQLは5.7互換に留める（JSON型はMySQL 5.7準拠）。
